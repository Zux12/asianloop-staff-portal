<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Asianloop Staff Portal — Login</title>

  <!-- Favicon (root) -->
  <link rel="icon" href="favicon.ico" type="image/x-icon"/>

  <!-- Styles -->
  <link rel="stylesheet" href="public/css/login.css"/>

  <!-- SEO / Social (optional for the portal) -->
  <meta property="og:title" content="Asianloop Staff Portal"/>
  <meta property="og:description" content="Authorized access for Asianloop staff."/>
  <meta property="og:type" content="website"/>
  <meta property="og:url" content="https://staff.asian-loop.com/"/>
  <meta property="og:site_name" content="Asianloop"/>
</head>
<body>
  <main class="login-wrap">
    <section class="login-card" aria-label="Staff sign-in">
      <a class="brand" href="/" aria-label="Asianloop Home">
        <img src="/public/images/logo.jpg" alt="Asianloop logo" />
      </a>

      <h1 class="title">Sign in to Asianloop Staff Portal</h1>
      <p class="subtitle">Use your <strong>@asian-loop.com</strong> email and password. Do not share your credentials.</p>

 <form id="loginForm" action="/login" method="post" novalidate>
  <div class="field">
    <label for="email">Work email</label>
    <input id="email" name="email" type="email" placeholder="name@asian-loop.com" autocomplete="username" required />
  </div>

  <div class="field" style="position:relative;">
    <label for="password">Password</label>
    <input id="password" name="password" type="password" placeholder="••••••••" autocomplete="current-password" required />
    <button type="button" id="togglePw" aria-label="Show password" style="position:absolute; right:10px; top:36px; background:none; border:0; color:#2a6df4; font-weight:700; cursor:pointer;">Show</button>
  </div>

<div class="field remember-row">
  <input id="rememberEmail" type="checkbox" />
  <label for="rememberEmail">Remember my email on this device</label>
</div>


  <button id="submitBtn" type="submit" class="btn-primary">Sign in</button>
  <p id="msg" class="msg" role="alert" aria-live="polite"></p>

  <div class="links">
    <button type="button" class="link" id="forgotLink" aria-haspopup="dialog" aria-controls="forgotDialog">Forgot password?</button>
    <a class="link" href="mailto:info@asian-loop.com?subject=Staff%20Portal%20Access%20Request">Need access?</a>
  </div>
</form>

    </section>

    <footer class="footer">
      <button type="button" class="link" id="privacyLink" aria-haspopup="dialog" aria-controls="privacyDialog">Privacy &amp; Acceptable Use</button>
      <span class="sep">•</span>
<a class="link" href="/privacy" rel="noopener">Open full policy</a>
      <div class="copyright">© <span id="year"></span> Asianloop Sdn Bhd — Internal use only.</div>
    </footer>
  </main>

  <!-- Forgot Password Dialog -->
  <dialog id="forgotDialog" class="modal" aria-labelledby="forgotTitle">
    <div class="modal-content">
      <h2 id="forgotTitle">Password Support</h2>
      <p>If you have forgotten your password or are unable to sign in, please contact the <strong>Asianloop IT Department</strong> directly.</p>
      <p>For security reasons, password resets cannot be performed automatically through this portal.</p>
      <p><strong>Contact method:</strong> Send an email to <a href="mailto:info@asian-loop.com">info@asian-loop.com</a> using your registered work email.</p>
      <p>In your message, please include:</p>
      <ul>
        <li>Your full name</li>
        <li>Department or project team</li>
        <li>Your staff ID (if applicable)</li>
        <li>A brief description of your login issue</li>
      </ul>
      <p>Once your request is received, IT will verify your identity and provide reset instructions. This process helps us ensure the safety of all accounts.</p>
      <div class="modal-actions">
        <button type="button" class="btn" data-close="forgotDialog">Close</button>
      </div>
    </div>
  </dialog>

  <!-- Privacy & Acceptable Use Dialog -->
  <dialog id="privacyDialog" class="modal" aria-labelledby="privacyTitle">
    <div class="modal-content">
      <h2 id="privacyTitle">Privacy &amp; Acceptable Use</h2>

      <h3>Account Ownership &amp; Security</h3>
      <p>Your account is tied to your <strong>@asian-loop.com</strong> identity and is for your use only. Keep credentials confidential and follow IT guidance for resets and recovery.</p>

      <h3>Authorized Use</h3>
      <p>Use this portal strictly for legitimate Asianloop work. Do not access, copy, or share information beyond your role or need-to-know.</p>

      <h3>Confidentiality &amp; Data Handling</h3>
      <p>Treat internal documents and data as confidential. Do not upload or share sensitive information to unapproved platforms or personal storage.</p>

      <h3>Monitoring &amp; Logging</h3>
      <p>Access to this portal may be monitored and logged (e.g., login attempts, admin changes) to protect users and systems.</p>

      <h3>Prohibited Activities</h3>
      <p>No unauthorized access attempts, credential sharing, bypassing of security controls, malware, or disruptive activities.</p>

      <h3>Devices &amp; Network</h3>
      <p>Use updated devices and browsers; avoid public/unsafe networks where possible. Report lost/stolen devices with active sessions immediately to IT.</p>

      <h3>Incident Reporting</h3>
      <p>Suspect a breach or see something unusual? Email <a href="mailto:info@asian-loop.com">info@asian-loop.com</a> with relevant details.</p>

      <h3>Consequences of Misuse</h3>
      <p>Violations may result in access suspension, disciplinary action, and/or legal remedies.</p>

      <p>— <strong>Asianloop IT &amp; Security</strong> (contact: <a href="mailto:info@asian-loop.com">info@asian-loop.com</a>)</p>

      <div class="modal-actions">
        <button type="button" class="btn" data-close="privacyDialog">Close</button>
      </div>
    </div>
  </dialog>

  <!-- Minimal page script: accessibility + validation  -->
  <script>
  // Footer year
  document.getElementById('year').textContent = new Date().getFullYear();

  // Dialog helpers
  function openDialog(id) {
    const dlg = document.getElementById(id);
    if (dlg && typeof dlg.showModal === 'function') dlg.showModal();
    else alert('Popup: ' + id); // fallback
  }
  function closeDialog(id) {
    const dlg = document.getElementById(id);
    if (dlg && typeof dlg.close === 'function') dlg.close();
  }

  // Wire dialog buttons
  document.getElementById('forgotLink').addEventListener('click', () => openDialog('forgotDialog'));
  document.getElementById('privacyLink').addEventListener('click', (e) => {
    const dlg = document.getElementById('privacyDialog');
    if (dlg && typeof dlg.showModal === 'function') {
      e.preventDefault();
      dlg.showModal();
    }
  });
  document.querySelectorAll('[data-close]').forEach(btn => {
    btn.addEventListener('click', (e) => closeDialog(e.target.getAttribute('data-close')));
  });
  document.querySelectorAll('dialog').forEach(dlg => {
    dlg.addEventListener('click', (e) => {
      const rect = dlg.getBoundingClientRect();
      const inside = e.clientX >= rect.left && e.clientX <= rect.right &&
                     e.clientY >= rect.top && e.clientY <= rect.bottom;
      if (!inside) dlg.close();
    });
  });

  // ----- Login form validation -----
  const form = document.getElementById('loginForm');
  const msg = document.getElementById('msg');

  form.addEventListener('submit', (e) => {
    msg.textContent = '';
    const email = (document.getElementById('email').value || '').trim();
    const pw = document.getElementById('password').value;

    if (!email) { 
      e.preventDefault(); 
      msg.textContent = 'Please enter your work email.'; 
      return; 
    }
    if (!email.toLowerCase().endsWith('@asian-loop.com')) { 
      e.preventDefault(); 
      msg.textContent = 'This portal only accepts @asian-loop.com emails.'; 
      return; 
    }
    if (!pw) { 
      e.preventDefault(); 
      msg.textContent = 'Please enter your password.'; 
      return; 
    }

    // If validation passes, the form submits normally to /login
    // Express handles IMAP auth and redirects to /dashboard
  });

  
// --- Remember my email ---
const emailInput = document.getElementById('email');
const rememberCb = document.getElementById('rememberEmail');

// Load saved email (if any)
try {
  const saved = localStorage.getItem('al_saved_email');
  if (saved) {
    emailInput.value = saved;
    rememberCb.checked = true;
  }
} catch (_) {}

// Save/remove on submit (if validation passes, we won’t preventDefault)
document.getElementById('loginForm').addEventListener('submit', (e) => {
  const valid = emailInput.value && emailInput.value.toLowerCase().endsWith('@asian-loop.com') && document.getElementById('password').value;
  if (valid) {
    try {
      if (rememberCb.checked) localStorage.setItem('al_saved_email', emailInput.value.trim());
      else localStorage.removeItem('al_saved_email');
    } catch (_) {}
  }
});

// --- Show/Hide password toggle ---
const pwInput = document.getElementById('password');
const togglePw = document.getElementById('togglePw');
togglePw.addEventListener('click', () => {
  const showing = pwInput.type === 'text';
  pwInput.type = showing ? 'password' : 'text';
  togglePw.textContent = showing ? 'Show' : 'Hide';
  togglePw.setAttribute('aria-label', showing ? 'Show password' : 'Hide password');
});

// --- Caps Lock warning (subtle UX helper) ---
pwInput.addEventListener('keydown', (e) => {
  if (e.getModifierState && e.getModifierState('CapsLock')) {
    document.getElementById('msg').textContent = 'Caps Lock is on.';
  } else if (document.getElementById('msg').textContent === 'Caps Lock is on.') {
    document.getElementById('msg').textContent = '';
  }
});


</script>

</body>
</html>
