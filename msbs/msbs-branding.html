<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MBS â€” Branding</title>
  <link rel="icon" href="/favicon.ico" />
  <link rel="stylesheet" href="/public/css/mbsdashboard.css" />

  <!-- THEME: Light default + Dark toggle -->
  <style>
    /* Palettes */
    :root, html[data-theme="light"]{
      color-scheme: light;
      --bg:#ffffff; --ink:#111111; --muted:#334155;
      --card:#ffffff; --border:#e5e7eb; --chip:#f1f5f9; --accent:#2563eb;
    }
    html[data-theme="dark"]{
      color-scheme: dark;
      --bg:#0b1220; --ink:#e5edf5; --muted:#93a3b8;
      --card:#0f172a; --border:#1f2937; --chip:#111827; --accent:#60a5fa;
    }

    /* Base application */
    body{background:var(--bg);color:var(--ink);}
    .al-header,.al-footer{background:var(--card);border-bottom:1px solid var(--border);}
    .al-footer{border-top:1px solid var(--border);border-bottom:none;}
    .al-sidemenu{background:var(--card);border-right:1px solid var(--border);}
    .al-sidemenu .item{color:var(--ink);}
    .al-sidemenu .item.active{background:rgba(37,99,235,.08);}
    .card,.table{background:var(--card);border:1px solid var(--border);}
    .table th,.table td{border-top:1px solid var(--border);color:var(--ink);}
    .link{color:var(--accent);}
    .badge{background:var(--chip);color:var(--ink);border:1px solid var(--border);}
    .placeholder{color:var(--muted);}

    /* Toggle button */
    .al-topnav .mode-toggle{
      display:inline-flex;align-items:center;gap:8px;
      font:inherit;padding:6px 10px;border:1px solid var(--border);
      background:var(--card);color:var(--ink);border-radius:8px;cursor:pointer;
    }
  </style>

  <!-- Higher contrast for light mode text -->
  <style id="contrast-patch">
    html[data-theme="light"], :root { --ink:#111111; --muted:#334155; }
    body,.al-main,.al-header,.al-sidemenu,.al-footer,
    .card,.table,h1,h2,h3,h4,h5,h6,p,li,dt,dd,small,span,label,legend{color:var(--ink);}
    html[data-theme="light"] a{color:#0b5dd7;} html[data-theme="light"] a:hover{color:#083a9b;}
    .table th{color:#111111;font-weight:600;}
    .muted,[class*="muted"]{color:var(--muted)!important;}
    .btn,.btn-ghost{color:var(--ink);} .btn-primary{background:var(--accent);color:#fff;}
    input,textarea,select{color:var(--ink);background:var(--card);} ::placeholder{color:#64748b;opacity:1;}
  </style>

  <!-- Left menu: black text when NOT hovered (light mode) -->
  <style id="sidemenu-ink">
    html[data-theme="light"] .al-sidemenu .item:not(:hover):not(.active),
    html[data-theme="light"] .al-sidemenu a.item:not(:hover):not(.active),
    html[data-theme="light"] .al-sidemenu .item:not(:hover):not(.active) .label{color:#111111!important;}
    html[data-theme="light"] .al-sidemenu .item:not(:hover):not(.active) svg{stroke:#111111!important;fill:none;}
  </style>
</head>

<body data-page="branding">
<header class="al-header">
<div class="al-inner">
<a class="al-brand" href="/">Asianloop Staff Portal</a>
<nav class="al-topnav">
  <span id="welcomeUser">Welcome, â€”</span>
  <button id="themeToggle" class="mode-toggle" type="button" title="Toggle theme">
    <span aria-hidden="true">ðŸŒ“</span> <span id="themeLabel">Dark mode</span>
  </button>
  <a href="/logout" class="btn btn-ghost">Logout</a>
</nav>

</div>
</header>

<div class="al-shell">
<aside class="al-sidemenu">
<div class="al-sidemenu-title">Market & Business Strategy</div>
<a class="item" href="/msbs">Overview</a>
<a class="item" href="/msbs/metrics">Metrics</a>
<a class="item" href="/msbs/events">Events</a>
<a class="item active" href="/msbs/branding">Branding</a>
<div class="divider"></div>
<div class="group-label">MBS Workspace</div>
<a class="item" href="/msbs/internal">Team Home</a>
</aside>

<main class="al-main">
<h1>Branding Assets</h1>

<section class="card">
<h2>Downloads</h2>
<!-- MONGO: msbs_brand_assets (public) served via /files/:id from GridFS bucket msbsFiles -->
<ul class="asset-list" id="brandAssetList">
<li class="placeholder">(Assets will appear here.)</li>
</ul>
</section>

<section class="card">
<h2>Usage Notes</h2>
<ul>
<li>Use lightâ€‘background logo on white or pale surfaces.</li>
<li>Use darkâ€‘background logo on photos or dark surfaces.</li>
<li>Keep clearâ€‘space and do not distort the logo.</li>
</ul>
</section>
</main>
</div>

<footer class="al-footer">Â© Asianloop â€¢ MBS</footer>

<script>
  (function(){ // boot
    var saved=localStorage.getItem('al_theme');
    var html=document.documentElement;
    html.setAttribute('data-theme', saved==='dark'?'dark':'light');
    var label=document.getElementById('themeLabel');
    if(label) label.textContent = (html.getAttribute('data-theme')==='dark')?'Light mode':'Dark mode';
  })();
  (function(){ // toggle
    var btn=document.getElementById('themeToggle'); if(!btn) return;
    btn.addEventListener('click',function(){
      var html=document.documentElement;
      var now=html.getAttribute('data-theme')==='dark'?'light':'dark';
      html.setAttribute('data-theme',now);
      localStorage.setItem('al_theme',now);
      var label=document.getElementById('themeLabel');
      if(label) label.textContent=(now==='dark')?'Light mode':'Dark mode';
    });
  })();
</script>

  
  <script>
(async function(){
  const ul = document.getElementById('brandAssetList');
  if (!ul) return;
  try {
    const r = await fetch('/api/msbs/brand-assets', { cache:'no-store', credentials:'same-origin' });
    if (!r.ok) throw 0;
    const items = await r.json();
    if (!items.length) return;

    ul.innerHTML = '';
    items.forEach(a => {
      const li = document.createElement('li');
      li.innerHTML = `<a class="link" href="${a.href}" target="_blank" rel="noopener">${a.title || 'Download'}</a>`;
      ul.appendChild(li);
    });
  } catch(_){}
})();

// Fill "Welcome, <email>" using cookie, then /me as fallback
(function () {
  var slot = document.getElementById('welcomeUser');
  if (!slot) return;

  function readCookie(n){
    var parts = (document.cookie || '').split('; ');
    for (var i=0;i<parts.length;i++){
      var p = parts[i], eq = p.indexOf('=');
      if (eq>-1 && decodeURIComponent(p.slice(0,eq))===n) {
        return decodeURIComponent(p.slice(eq+1));
      }
    }
    return null;
  }

  var email = readCookie('al_user_email');
  if (email) { slot.textContent = 'Welcome, ' + email; return; }

  fetch('/me', { cache:'no-store', credentials:'same-origin' })
    .then(function(r){ return r.ok ? r.json() : {}; })
    .then(function(u){ if (u && u.email) slot.textContent = 'Welcome, ' + u.email; })
    .catch(function(){});
})();
</script>

  
</body>
</html>
