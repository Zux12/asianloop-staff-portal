<!DOCTYPE html>
<link rel="icon" href="/favicon.ico" />

<link rel="stylesheet" href="/public/css/mbsdashboard.css" />

</head>
<body data-page="branding">
<header class="al-header">
<div class="al-inner">
<a class="al-brand" href="/">Asianloop Staff Portal</a>
<nav class="al-topnav">
  <span id="welcomeUser">Welcome, —</span>

<a href="/logout" class="btn btn-ghost">Logout</a>
</nav>
</div>
</header>

<div class="al-shell">
<aside class="al-sidemenu">
<div class="al-sidemenu-title">Market & Business Strategy</div>
<a class="item" href="/msbs">Overview</a>
<a class="item" href="/msbs/metrics">Metrics</a>
<a class="item" href="/msbs/events">Events</a>
<a class="item active" href="/msbs/branding">Branding</a>
<div class="divider"></div>
<div class="group-label">MBS Workspace</div>
<a class="item" href="/msbs/internal">Team Home</a>
</aside>

<main class="al-main">
<h1>Branding Assets</h1>

<section class="card">
<h2>Downloads</h2>
<!-- MONGO: msbs_brand_assets (public) served via /files/:id from GridFS bucket msbsFiles -->
<ul class="asset-list" id="brandAssetList">
<li class="placeholder">(Assets will appear here.)</li>
</ul>
</section>

<section class="card">
<h2>Usage Notes</h2>
<ul>
<li>Use light‑background logo on white or pale surfaces.</li>
<li>Use dark‑background logo on photos or dark surfaces.</li>
<li>Keep clear‑space and do not distort the logo.</li>
</ul>
</section>
</main>
</div>

<footer class="al-footer">© Asianloop • MBS</footer>

  <script>
(async function(){
  const ul = document.getElementById('brandAssetList');
  if (!ul) return;
  try {
    const r = await fetch('/api/msbs/brand-assets', { cache:'no-store', credentials:'same-origin' });
    if (!r.ok) throw 0;
    const items = await r.json();
    if (!items.length) return;

    ul.innerHTML = '';
    items.forEach(a => {
      const li = document.createElement('li');
      li.innerHTML = `<a class="link" href="${a.href}" target="_blank" rel="noopener">${a.title || 'Download'}</a>`;
      ul.appendChild(li);
    });
  } catch(_){}
})();

// Fill "Welcome, <email>" using cookie, then /me as fallback
(function () {
  var slot = document.getElementById('welcomeUser');
  if (!slot) return;

  function readCookie(n){
    var parts = (document.cookie || '').split('; ');
    for (var i=0;i<parts.length;i++){
      var p = parts[i], eq = p.indexOf('=');
      if (eq>-1 && decodeURIComponent(p.slice(0,eq))===n) {
        return decodeURIComponent(p.slice(eq+1));
      }
    }
    return null;
  }

  var email = readCookie('al_user_email');
  if (email) { slot.textContent = 'Welcome, ' + email; return; }

  fetch('/me', { cache:'no-store', credentials:'same-origin' })
    .then(function(r){ return r.ok ? r.json() : {}; })
    .then(function(u){ if (u && u.email) slot.textContent = 'Welcome, ' + u.email; })
    .catch(function(){});
})();
</script>

  
</body>
</html>
